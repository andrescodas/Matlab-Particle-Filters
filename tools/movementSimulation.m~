function [newRobotPosition,rflexPosition,rflexCovariance] = movementSimulation(piloMove,robotPosition,rflexBaseAngle,rflexPosition)


ifa2a = 0.1;  % imprecisionFactorAxial2Axial
ifa2t = 0.01; % imprecisionFactorAxial2Transversal
ift2t = 0.1;  % imprecisionFactorTransversal2Transversal
ift2a = 0.01; % imprecisionFactorTransversal2Axial
ifo = 0.05;   % imprecisionFactorOrientation

rflexCovariance = diag([ifa2a*abs(piloMove(1)) + ift2a*abs(piloMove(2)), ift2t*abs(piloMove(2))+ifa2t*abs(piloMove(1)),ifo*abs(piloMove(3))]).^2;

rflexCovarianceSQRT = sqrt(rflexCovariance);


uNoiseRobot = rflexCovarianceSQRT*randn(3,1)/10;
uNoiseRflex = rflexCovarianceSQRT*randn(3,1);


newRobotPosition = robotPosition + rotation(piloMove + uNoiseRobot',rflexBaseAngle); 
newRobotPosition(3) = angleWrap(newRobotPosition(3));

rflexPosition = rflexPosition + piloMove + uNoiseRflex';
rflexPosition(3) = angleWrap(rflexPosition(3));
